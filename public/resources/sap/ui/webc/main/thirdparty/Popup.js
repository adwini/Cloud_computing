sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/Render","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/Device","sap/ui/webc/common/thirdparty/base/util/FocusableElements","sap/ui/webc/common/thirdparty/base/util/AriaLabelHelper","sap/ui/webc/common/thirdparty/base/ManagedStyles","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/util/PopupUtils","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/MediaRange","./generated/templates/PopupTemplate.lit","./generated/templates/PopupBlockLayerTemplate.lit","./popup-utils/OpenedPopupsRegistry","./generated/themes/Popup.css","./generated/themes/PopupStaticAreaStyles.css","./generated/themes/PopupGlobal.css"],function(e,t,s,o,i,a,r,n,l,u,c,p,d,h,f,m,g,y){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;s=b(s);o=b(o);c=b(c);p=b(p);d=b(d);h=b(h);m=b(m);g=b(g);y=b(y);function b(e){return e&&e.__esModule?e:{default:e}}const _={managedSlots:true,slots:{default:{type:HTMLElement,propertyName:"content"}},properties:{initialFocus:{type:String},preventFocusRestore:{type:Boolean},open:{type:Boolean},opened:{type:Boolean,noAttribute:true},accessibleName:{type:String,defaultValue:undefined},accessibleNameRef:{type:String,defaultValue:""},mediaRange:{type:String},_disableInitialFocus:{type:Boolean},_blockLayerHidden:{type:Boolean}},events:{"before-open":{},"after-open":{},"before-close":{detail:{escPressed:{type:Boolean}}},"after-close":{},scroll:{}}};const F=()=>{if(!(0,n.hasStyle)("data-ui5-popup-scroll-blocker")){(0,n.createStyle)(y.default,"data-ui5-popup-scroll-blocker")}};F();const w=new Set;class E extends o.default{constructor(){super();this._resizeHandler=this._resize.bind(this)}static get metadata(){return _}static get render(){return s.default}static get styles(){return m.default}static get template(){return d.default}static get staticAreaTemplate(){return h.default}static get staticAreaStyles(){return g.default}onEnterDOM(){if(!this.isOpen()){this._blockLayerHidden=true}c.default.register(this,this._resizeHandler)}onExitDOM(){if(this.isOpen()){E.unblockPageScrolling(this);this._removeOpenedPopup()}c.default.deregister(this,this._resizeHandler)}get _displayProp(){return"block"}_resize(){this.mediaRange=p.default.getCurrentRange(p.default.RANGESETS.RANGE_4STEPS,this.getDomRef().offsetWidth)}_preventBlockLayerFocus(e){e.preventDefault()}static blockPageScrolling(e){w.add(e);if(w.size!==1){return}document.documentElement.classList.add("ui5-popup-scroll-blocker")}static unblockPageScrolling(e){w.delete(e);if(w.size!==0){return}document.documentElement.classList.remove("ui5-popup-scroll-blocker")}_scroll(e){this.fireEvent("scroll",{scrollTop:e.target.scrollTop,targetRef:e.target})}_onkeydown(e){if(e.target===this._root&&(0,l.isTabPrevious)(e)){e.preventDefault()}}_onfocusout(e){if(!e.relatedTarget){this._shouldFocusRoot=true}}_onmousedown(e){this._root.removeAttribute("tabindex");if(this.shadowRoot.contains(e.target)){this._shouldFocusRoot=true}else{this._shouldFocusRoot=false}}_onmouseup(){this._root.tabIndex=-1;if(this._shouldFocusRoot){if((0,i.isChrome)()){this._root.focus()}this._shouldFocusRoot=false}}async forwardToFirst(){const e=await(0,a.getFirstFocusableElement)(this);if(e){e.focus()}else{this._root.focus()}}async forwardToLast(){const e=await(0,a.getLastFocusableElement)(this);if(e){e.focus()}else{this._root.focus()}}async applyInitialFocus(){await this.applyFocus()}async applyFocus(){await this._waitForDomRef();const e=this.getRootNode().getElementById(this.initialFocus)||document.getElementById(this.initialFocus)||await(0,a.getFirstFocusableElement)(this)||this._root;if(e){if(e===this._root){e.tabIndex=-1}e.focus()}}isOpen(){return this.opened}isFocusWithin(){return(0,u.isFocusedElementWithinNode)(this.shadowRoot.querySelector(".ui5-popup-root"))}async _open(e){const s=!this.fireEvent("before-open",{},true,false);if(s){return}if(this.isModal&&!this.shouldHideBackdrop){this.getStaticAreaItemDomRef();this._blockLayerHidden=false;E.blockPageScrolling(this)}this._zIndex=(0,u.getNextZIndex)();this.style.zIndex=this._zIndex;this._focusedElementBeforeOpen=(0,u.getFocusedElement)();this._show();if(!this._disableInitialFocus&&!e){this.applyInitialFocus()}this._addOpenedPopup();this.opened=true;this.open=true;await(0,t.renderFinished)();this.fireEvent("after-open",{},false,false)}_addOpenedPopup(){(0,f.addOpenedPopup)(this)}close(e=false,t=false,s=false){if(!this.opened){return}const o=!this.fireEvent("before-close",{escPressed:e},true,false);if(o){return}if(this.isModal){this._blockLayerHidden=true;E.unblockPageScrolling(this)}this.hide();this.opened=false;this.open=false;if(!t){this._removeOpenedPopup()}if(!this.preventFocusRestore&&!s){this.resetFocus()}this.fireEvent("after-close",{},false,false)}_removeOpenedPopup(){(0,f.removeOpenedPopup)(this)}resetFocus(){if(!this._focusedElementBeforeOpen){return}this._focusedElementBeforeOpen.focus();this._focusedElementBeforeOpen=null}_show(){this.style.display=this._displayProp}hide(){this.style.display="none"}get isModal(){}get shouldHideBackdrop(){}get _ariaLabelledBy(){}get _ariaModal(){}get _ariaLabel(){return(0,r.getEffectiveAriaLabelText)(this)}get _root(){return this.shadowRoot.querySelector(".ui5-popup-root")}get contentDOM(){return this.shadowRoot.querySelector(".ui5-popup-content")}get styles(){return{root:{},content:{},blockLayer:{zIndex:this._zIndex-1}}}get classes(){return{root:{"ui5-popup-root":true},content:{"ui5-popup-content":true}}}}var R=E;e.default=R});
//# sourceMappingURL=Popup.js.map