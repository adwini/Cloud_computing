sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/Render","sap/ui/webc/common/thirdparty/localization/dates/CalendarDate","sap/ui/webc/common/thirdparty/localization/dates/modifyDateBy","sap/ui/webc/common/thirdparty/localization/dates/getTodayUTCTimestamp","./generated/i18n/i18n-defaults","./generated/themes/DateRangePicker.css","./DatePicker"],function(e,t,i,a,s,r,l,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;i=u(i);a=u(a);s=u(s);l=u(l);n=u(n);function u(e){return e&&e.__esModule?e:{default:e}}const m={tag:"ui5-daterange-picker",properties:{delimiter:{type:String,defaultValue:"-"},_tempValue:{type:String}}};class d extends n.default{static get metadata(){return m}static get styles(){return[n.default.styles,l.default]}constructor(){super();this._prevDelimiter=null}get dateValue(){return null}get dateValueUTC(){return null}get _startDateTimestamp(){return this._extractFirstTimestamp(this.value)}get _endDateTimestamp(){return this._extractLastTimestamp(this.value)}get _tempTimestamp(){return this._tempValue&&this.getFormat().parse(this._tempValue,true).getTime()/1e3}get _calendarSelectionMode(){return"Range"}get _calendarTimestamp(){return this._tempTimestamp||this._startDateTimestamp||(0,s.default)(this._primaryCalendarType)}get _calendarSelectedDates(){if(this._tempValue){return[this._tempValue]}if(this.value&&this._checkValueValidity(this.value)){return this._splitValueByDelimiter(this.value)}return[]}get startDateValue(){return i.default.fromTimestamp(this._startDateTimestamp*1e3).toLocalJSDate()}get endDateValue(){return i.default.fromTimestamp(this._endDateTimestamp*1e3).toLocalJSDate()}get _placeholder(){return this.placeholder!==undefined?this.placeholder:`${this._displayFormat} ${this._effectiveDelimiter} ${this._displayFormat}`}get dateAriaDescription(){return d.i18nBundle.getText(r.DATERANGE_DESCRIPTION)}async _onInputSubmit(e){const i=this._getInput();const a=i.getCaretPosition();await(0,t.renderFinished)();i.setCaretPosition(a)}onResponsivePopoverAfterClose(){this._tempValue="";super.onResponsivePopoverAfterClose()}isValid(e){const t=this._splitValueByDelimiter(e);return t.length<=2&&t.every(e=>super.isValid(e))}isInValidRange(e){return this._splitValueByDelimiter(e).every(e=>super.isInValidRange(e))}normalizeValue(e){const t=this._extractFirstTimestamp(e);const i=this._extractLastTimestamp(e);if(t&&i&&t>i){return this._buildValue(i,t)}return this._buildValue(t,i)}onSelectedDatesChange(e){e.preventDefault();const t=e.detail.values;if(t.length===0){return}if(t.length===1){this._tempValue=t[0];return}const i=this._buildValue(...e.detail.dates);this._updateValueAndFireEvents(i,true,["change","value-changed"]);this.closePicker()}async _modifyDateValue(e,s){if(!this._endDateTimestamp){return super._modifyDateValue(e,s)}const r=this._getInput();let l=r.getCaretPosition();let n;if(l<=this.value.indexOf(this._effectiveDelimiter)){const t=(0,a.default)(i.default.fromTimestamp(this._startDateTimestamp*1e3),e,s,this._minDate,this._maxDate);const r=t.valueOf()/1e3;if(r>this._endDateTimestamp){l+=Math.ceil(this.value.length/2)}n=this._buildValue(r,this._endDateTimestamp)}else{const t=(0,a.default)(i.default.fromTimestamp(this._endDateTimestamp*1e3),e,s,this._minDate,this._maxDate);const r=t.valueOf()/1e3;n=this._buildValue(this._startDateTimestamp,r);if(r<this._startDateTimestamp){l-=Math.ceil(this.value.length/2)}}this._updateValueAndFireEvents(n,true,["change","value-changed"]);await(0,t.renderFinished)();r.setCaretPosition(l)}get _effectiveDelimiter(){return this.delimiter||this.constructor.getMetadata().getProperties().delimiter.defaultValue}_splitValueByDelimiter(e){const t=[];const i=e.split(this._prevDelimiter||this._effectiveDelimiter);t[0]=i.slice(0,i.length/2).join(this._effectiveDelimiter);t[1]=i.slice(i.length/2).join(this._effectiveDelimiter);return t}_extractFirstTimestamp(e){if(!e||!this._checkValueValidity(e)){return undefined}const t=this._splitValueByDelimiter(e);return this.getFormat().parse(t[0],true).getTime()/1e3}_extractLastTimestamp(e){if(!e||!this._checkValueValidity(e)){return undefined}const t=this._splitValueByDelimiter(e);if(t[1]){return this.getFormat().parse(t[1],true).getTime()/1e3}return undefined}_buildValue(e,t){this._prevDelimiter=this._effectiveDelimiter;if(e){const i=this._getStringFromTimestamp(e*1e3);if(!t){return i}const a=this._getStringFromTimestamp(t*1e3);return`${i} ${this._effectiveDelimiter} ${a}`}return""}}d.define();var h=d;e.default=h});
//# sourceMappingURL=DateRangePicker.js.map