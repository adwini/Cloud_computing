sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/types/ValueState","sap/ui/webc/common/thirdparty/base/FeaturesRegistry","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/base/Keys","./generated/i18n/i18n-defaults","./Input","./Popover","./Icon","./generated/templates/FileUploaderTemplate.lit","./generated/templates/FileUploaderPopoverTemplate.lit","./generated/themes/FileUploader.css","./generated/themes/ResponsivePopoverCommon.css","./generated/themes/ValueStateMessage.css"],function(e,t,a,s,i,r,n,u,o,l,p,d,c,h,f,g){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=m(t);a=m(a);i=m(i);o=m(o);l=m(l);p=m(p);d=m(d);c=m(c);h=m(h);f=m(f);g=m(g);function m(e){return e&&e.__esModule?e:{default:e}}const S={tag:"ui5-file-uploader",languageAware:true,properties:{accept:{type:String},hideInput:{type:Boolean},disabled:{type:Boolean},multiple:{type:Boolean},name:{type:String},placeholder:{type:String},value:{type:String},valueState:{type:a.default,defaultValue:a.default.None},focused:{type:Boolean}},managedSlots:true,slots:{default:{propertyName:"content",type:HTMLElement},valueStateMessage:{type:HTMLElement},formSupport:{type:HTMLElement}},events:{change:{detail:{files:{type:FileList}}}}};class v extends t.default{static get formAssociated(){return true}static get metadata(){return S}static get render(){return i.default}static get styles(){return h.default}static get template(){return d.default}static get staticAreaTemplate(){return c.default}static get staticAreaStyles(){return[f.default,g.default]}constructor(){super();this._internals=this.attachInternals&&this.attachInternals()}_onmouseover(){this.content.forEach(e=>{e.classList.add("ui5_hovered")})}_onmouseout(){this.content.forEach(e=>{e.classList.remove("ui5_hovered")})}_onclick(e){if(e.isMarked==="button"){this._input.click(e)}}_onkeydown(e){if((0,n.isEnter)(e)){this._input.click(e);e.preventDefault()}}_onkeyup(e){if((0,n.isSpace)(e)){this._input.click(e);e.preventDefault()}}_onfocusin(){this.focused=true}_onfocusout(){this.focused=false}get files(){if(this._input){return this._input.files}return v._emptyFilesList}onBeforeRendering(){this._enableFormSupport()}onAfterRendering(){if(!this.value){this._input.value=""}this.toggleValueStatePopover(this.shouldOpenValueStateMessagePopover)}_enableFormSupport(){const e=(0,s.getFeature)("FormSupport");if(e){if(this._canUseNativeFormSupport){this._setFormValue()}else{e.syncNativeFileInput(this,(e,t)=>{t.disabled=e.disabled},this._onChange.bind(this))}}else if(this.name){console.warn(`In order for the "name" property to have effect, you should also: import "@ui5/webcomponents/dist/features/InputElementsFormSupport.js";`)}}_onChange(e){this._updateValue(e.target.files);this.fireEvent("change",{files:e.target.files})}_updateValue(e){this.value=Array.from(e).reduce((e,t)=>`${e}"${t.name}" `,"")}_setFormValue(){const e=new FormData;for(let t=0;t<this.files.length;t++){e.append(this.name,this.files[t])}this._internals.setFormValue(e)}toggleValueStatePopover(e){if(e){this.openValueStatePopover()}else{this.closeValueStatePopover()}}async openValueStatePopover(){const e=await this._getPopover();if(e){e.showAt(this)}}async closeValueStatePopover(){const e=await this._getPopover();if(e){e.close()}}async _getPopover(){const e=await this.getStaticAreaItemDomRef();return e.querySelector(".ui5-valuestatemessage-popover")}static get _emptyFilesList(){if(!this.emptyInput){this.emptyInput=document.createElement("input");this.emptyInput.type="file"}return this.emptyInput.files}get browseText(){return v.i18nBundle.getText(u.FILEUPLOAD_BROWSE)}get titleText(){return v.i18nBundle.getText(u.FILEUPLOADER_TITLE)}get _canUseNativeFormSupport(){return this._internals&&this._internals.setFormValue}get _keepInputInShadowDOM(){return this._canUseNativeFormSupport||!this.name}get _input(){return this.shadowRoot.querySelector("input[type=file]")||this.querySelector("input[type=file][data-ui5-form-support]")}get _type(){return"file"}get valueStateTextMappings(){return{Success:v.i18nBundle.getText(u.VALUE_STATE_SUCCESS),Information:v.i18nBundle.getText(u.VALUE_STATE_INFORMATION),Error:v.i18nBundle.getText(u.VALUE_STATE_ERROR),Warning:v.i18nBundle.getText(u.VALUE_STATE_WARNING)}}get valueStateText(){return this.valueStateTextMappings[this.valueState]}get hasValueState(){return this.valueState!==a.default.None}get hasValueStateText(){return this.hasValueState&&this.valueState!==a.default.Success}get valueStateMessageText(){return this.getSlottedNodes("valueStateMessage").map(e=>e.cloneNode(true))}get shouldDisplayDefaultValueStateMessage(){return!this.valueStateMessage.length&&this.hasValueStateText}get shouldOpenValueStateMessagePopover(){return this.focused&&this.hasValueStateText&&!this.hideInput}get _valueStateMessageInputIcon(){const e={Error:"error",Warning:"alert",Success:"sys-enter-2",Information:"information"};return this.valueState!==a.default.None?e[this.valueState]:""}get classes(){return{popoverValueState:{"ui5-valuestatemessage-root":true,"ui5-valuestatemessage--success":this.valueState===a.default.Success,"ui5-valuestatemessage--error":this.valueState===a.default.Error,"ui5-valuestatemessage--warning":this.valueState===a.default.Warning,"ui5-valuestatemessage--information":this.valueState===a.default.Information}}}get styles(){return{popoverHeader:{width:`${this.ui5Input?this.ui5Input.offsetWidth:0}px`}}}get ui5Input(){return this.shadowRoot.querySelector(".ui5-file-uploader-input")}static get dependencies(){return[o.default,l.default,p.default]}static async onDefine(){v.i18nBundle=await(0,r.getI18nBundle)("@ui5/webcomponents")}}v.define();var y=v;e.default=y});
//# sourceMappingURL=FileUploader.js.map