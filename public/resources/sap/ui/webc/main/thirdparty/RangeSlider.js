sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/types/Float","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/base/Keys","./SliderBase","./Icon","./generated/templates/RangeSliderTemplate.lit","./generated/i18n/i18n-defaults","./generated/themes/RangeSlider.css"],function(e,t,s,i,a,n,r,l,u){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=d(t);a=d(a);n=d(n);r=d(r);u=d(u);function d(e){return e&&e.__esModule?e:{default:e}}const o={tag:"ui5-range-slider",languageAware:true,managedSlots:true,properties:{startValue:{type:t.default,defaultValue:0},endValue:{type:t.default,defaultValue:100},rangePressed:{type:Boolean}}};class h extends a.default{static get metadata(){return o}static get template(){return r.default}static get VALUES(){return{start:"startValue",end:"endValue"}}static get dependencies(){return[n.default]}static get styles(){return[a.default.styles,u.default]}constructor(){super();this._stateStorage.startValue=null;this._stateStorage.endValue=null}get tooltipStartValue(){const e=this.constructor._getDecimalPrecisionOfNumber(this._effectiveStep);return this.startValue.toFixed(e)}get tooltipEndValue(){const e=this.constructor._getDecimalPrecisionOfNumber(this._effectiveStep);return this.endValue.toFixed(e)}get _ariaDisabled(){return this.disabled||undefined}get _ariaLabelledByText(){return h.i18nBundle.getText(l.RANGE_SLIDER_ARIA_DESCRIPTION)}get _ariaHandlesText(){const e=this.effectiveDir==="rtl";const t=this._areValuesReversed();const s={};if(e&&!t||!e&&t){s.startHandleText=h.i18nBundle.getText(l.RANGE_SLIDER_END_HANDLE_DESCRIPTION);s.endHandleText=h.i18nBundle.getText(l.RANGE_SLIDER_START_HANDLE_DESCRIPTION)}else{s.startHandleText=h.i18nBundle.getText(l.RANGE_SLIDER_START_HANDLE_DESCRIPTION);s.endHandleText=h.i18nBundle.getText(l.RANGE_SLIDER_END_HANDLE_DESCRIPTION)}return s}onBeforeRendering(){if(!this.isCurrentStateOutdated()){return}this.notResized=true;this.syncUIAndState("startValue","endValue");this._updateHandlesAndRange(null)}_onfocusin(e){if(!this._getInitialValue("endValue")){this._setInitialValue("startValue",this.startValue);this._setInitialValue("endValue",this.endValue)}if(this.showTooltip){this._tooltipVisibility=a.default.TOOLTIP_VISIBILITY.VISIBLE}}_onfocusout(e){if(this._isFocusing()){this._preventFocusOut();return}this._setAffectedValue(null);this._setInitialValue("startValue",null);this._setInitialValue("endValue",null);if(this.showTooltip){this._tooltipVisibility=a.default.TOOLTIP_VISIBILITY.HIDDEN}}_onkeyup(e){super._onkeyup(e);this._swapValues();this._setAffectedValue(null)}_handleActionKeyPress(e){if((0,i.isEscape)(e)){this.update(null,this._getInitialValue("startValue"),this._getInitialValue("endValue"));return}this._setAffectedValueByFocusedElement();const t=this._effectiveMin;const s=this._effectiveMax;const a=this._valueAffected;if(((0,i.isEnd)(e)||(0,i.isHome)(e))&&!a){this._homeEndForSelectedRange(e,(0,i.isHome)(e)?"startValue":"endValue",t,s);return}const n=this._handleActionKeyPressBase(e,a);if(!n){return}if(a&&!this._isPressInCurrentRange){const e=this.constructor.clipValue(n+this[a],t,s);this.update(a,e,null)}else if(n<0&&this.startValue>t||n>0&&this.endValue<s){const e=this.constructor.clipValue(n+this.startValue,t,s);const i=this.constructor.clipValue(n+this.endValue,t,s);this.update(a,e,i)}}_setAffectedValueByFocusedElement(){if(this.shadowRoot.activeElement===this._startHandle){this._setAffectedValue(h.VALUES.start)}if(this.shadowRoot.activeElement===this._endHandle){this._setAffectedValue(h.VALUES.end)}if(this.shadowRoot.activeElement===this._progressBar){this._setAffectedValue(null)}this._setIsPressInCurrentRange(!this._valueAffected)}_homeEndForSelectedRange(e,t,s,i){const a=this._handleActionKeyPressBase(e,t);const n=this.constructor.clipValue(a+this.startValue,s,i);const r=this.constructor.clipValue(a+this.endValue,s,i);this.update(null,n,r)}update(e,t,s){if(!e){this.updateValue("startValue",t);this.updateValue("endValue",s);this._updateHandlesAndRange(null)}else{const s=t;this._updateHandlesAndRange(s);this.updateValue(e,s)}}_onmousedown(e){if(this.disabled||this._effectiveStep===0){return}const t=this.handleDownBase(e);this._saveInteractionStartData(e,t);this.rangePressed=this._isPressInCurrentRange;if(this._isPressInCurrentRange||this._handeIsPressed){this._handeIsPressed=false;return}this.update(this._valueAffected,t,null)}_saveInteractionStartData(e,t){const s=this.shadowRoot.querySelector(".ui5-slider-progress").getBoundingClientRect();this._startValueAtBeginningOfAction=this.startValue;this._endValueAtBeginningOfAction=this.endValue;this._initialPageXPosition=this.constructor.getPageXValueFromEvent(e);this._pressTargetAndAffectedValue(this._initialPageXPosition,t);this._initialStartHandlePageX=this.directionStart==="left"?s.left:s.right}_handleMove(e){e.preventDefault();if(this.disabled||this._effectiveStep===0){return}if(!this._isPressInCurrentRange){this._updateValueOnHandleDrag(e);return}this._updateValueOnRangeDrag(e)}_updateValueOnHandleDrag(e){const t=this.constructor.getValueFromInteraction(e,this._effectiveStep,this._effectiveMin,this._effectiveMax,this.getBoundingClientRect(),this.directionStart);this.update(this._valueAffected,t,null)}_updateValueOnRangeDrag(e){const t=this.constructor.getPageXValueFromEvent(e);const s=this._calculateRangeOffset(t,this._initialStartHandlePageX);this._setAffectedValue(null);this.update(null,s[0],s[1])}_handleUp(){if(this.startValue!==this._startValueAtBeginningOfAction||this.endValue!==this._endValueAtBeginningOfAction){this.fireEvent("change")}this._swapValues();this._setAffectedValueByFocusedElement();this._setAffectedValue(null);this._startValueAtBeginningOfAction=null;this._endValueAtBeginningOfAction=null;this._setIsPressInCurrentRange(false);this.handleUpBase();this.rangePressed=false}_pressTargetAndAffectedValue(e,t){const s=this.shadowRoot.querySelector(".ui5-slider-handle--start");const i=this.shadowRoot.querySelector(".ui5-slider-handle--end");const a=s.getBoundingClientRect();const n=i.getBoundingClientRect();const r=e>=a.left&&e<=a.right;const l=e>=n.left&&e<=n.right;if(l||r){this._handeIsPressed=true}if(l||t>this.endValue){this._setAffectedValue(h.VALUES.end)}if(r||t<this.startValue){this._setAffectedValue(h.VALUES.start)}const u=t>=this._startValueAtBeginningOfAction&&t<=this._endValueAtBeginningOfAction;this._setIsPressInCurrentRange(!(this._valueAffected||this._handeIsPressed)?u:false)}_setAffectedValue(e){this._valueAffected=e;if(this._areValuesReversed()){this._setValuesAreReversed()}}_setIsPressInCurrentRange(e){this._isPressInCurrentRange=e}focusInnerElement(){const e=this._areValuesReversed();const t=this._valueAffected;if(this._isPressInCurrentRange||!t){this._progressBar.focus()}if(t===h.VALUES.start&&!e||t===h.VALUES.end&&e){this._startHandle.focus()}if(t===h.VALUES.end&&!e||t===h.VALUES.start&&e){this._endHandle.focus()}}_calculateRangeOffset(e,t){if(this._initialPageXPosition===e){return[this.startValue,this.endValue]}const s=this._effectiveMin;const i=this._effectiveMax;const a=this.endValue-this.startValue;let n=this._calculateStartValueByOffset(e,t);n=this.constructor.clipValue(n,s,i-a);return[n,n+a]}_calculateStartValueByOffset(e,t){const s=this._effectiveMin;const i=this._effectiveMax;const a=this._effectiveStep;const n=this.getBoundingClientRect();let r;let l;let u;if(e>this._initialPageXPosition){u=e-this._initialPageXPosition;l=t+u;r=this.constructor.computedValueFromPageX(l,s,i,n,this.directionStart);r=this.constructor.getSteppedValue(r,a,s)}else{u=this._initialPageXPosition-e;l=t-u;r=this.constructor.computedValueFromPageX(l,s,i,n,this.directionStart);r=this.constructor.getSteppedValue(r,a,s)}return r}_updateHandlesAndRange(e){const t=this._effectiveMax;const s=this._effectiveMin;const i=this.getStoredPropertyState("startValue");const a=this.getStoredPropertyState("endValue");const n=this._valueAffected;if(n===h.VALUES.start){this._selectedRange=(a-e)/(t-s);this._firstHandlePositionFromStart=(e-s)/(t-s)*100}else if(n===h.VALUES.end){this._selectedRange=(e-i)/(t-s);this._secondHandlePositionFromStart=(e-s)/(t-s)*100}else{this._selectedRange=(this.endValue-this.startValue)/(t-s);this._firstHandlePositionFromStart=(this.startValue-s)/(t-s)*100;this._secondHandlePositionFromStart=(this.endValue-s)/(t-s)*100}}_swapValues(){const e=this._valueAffected;if(e===h.VALUES.start&&this.startValue>this.endValue){const e=this.endValue;this.endValue=this.startValue;this.startValue=e;this._setValuesAreReversed();this.focusInnerElement()}if(e===h.VALUES.end&&this.endValue<this.startValue){const e=this.startValue;this.startValue=this.endValue;this.endValue=e;this._setValuesAreReversed();this.focusInnerElement()}}_setValuesAreReversed(){this._reversedValues=!this._reversedValues}_areValuesReversed(){return this._reversedValues}get tickmarksObject(){const e=this._tickmarksCount;const t=[];if(this._hiddenTickmarks){return[false,false]}for(let s=0;s<=e;s++){const e=this._effectiveMin+s*this.step>=this.startValue;const i=this._effectiveMin+s*this.step<=this.endValue;t.push(e&&i)}return t}get _startHandle(){return this.shadowRoot.querySelector(".ui5-slider-handle--start")}get _endHandle(){return this.shadowRoot.querySelector(".ui5-slider-handle--end")}get _progressBar(){return this.shadowRoot.querySelector(".ui5-slider-progress")}get _ariaLabelledByStartHandleRefs(){return[`${this._id}-accName`,`${this._id}-startHandleDesc`].join(" ").trim()}get _ariaLabelledByEndHandleRefs(){return[`${this._id}-accName`,`${this._id}-endHandleDesc`].join(" ").trim()}get _ariaLabelledByProgressBarRefs(){return[`${this._id}-accName`,`${this._id}-sliderDesc`].join(" ").trim()}get styles(){return{progress:{width:`${this._selectedRange*100}%`,"transform-origin":`${this.directionStart} top`,[this.directionStart]:`${this._firstHandlePositionFromStart}%`},startHandle:{[this.directionStart]:`${this._firstHandlePositionFromStart}%`},endHandle:{[this.directionStart]:`${this._secondHandlePositionFromStart}%`},tickmarks:{background:`${this._tickmarks}`},label:{width:`${this._labelWidth}%`},labelContainer:{width:`100%`,[this.directionStart]:`-${this._labelWidth/2}%`},tooltip:{visibility:`${this._tooltipVisibility}`}}}static async onDefine(){h.i18nBundle=await(0,s.getI18nBundle)("@ui5/webcomponents")}}h.define();var c=h;e.default=c});
//# sourceMappingURL=RangeSlider.js.map