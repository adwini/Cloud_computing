sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/base/types/ValueState","sap/ui/webc/common/thirdparty/base/util/AriaLabelHelper","sap/ui/webc/common/thirdparty/base/FeaturesRegistry","sap/ui/webc/common/thirdparty/base/types/Float","sap/ui/webc/common/thirdparty/base/types/Integer","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","./generated/templates/StepInputTemplate.lit","./generated/i18n/i18n-defaults","sap/ui/webc/common/thirdparty/icons/less","sap/ui/webc/common/thirdparty/icons/add","./Icon","./Input","./types/InputType","./generated/themes/StepInput.css"],function(e,t,i,s,u,a,n,o,r,l,h,d,p,c,f,_,m,v){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=y(t);u=y(u);o=y(o);r=y(r);l=y(l);h=y(h);f=y(f);_=y(_);m=y(m);v=y(v);function y(e){return e&&e.__esModule?e:{default:e}}const b={tag:"ui5-step-input",managedSlots:true,properties:{value:{type:o.default,defaultValue:0},min:{type:o.default},max:{type:o.default},step:{type:o.default,defaultValue:1},valueState:{type:u.default,defaultValue:u.default.None},required:{type:Boolean},disabled:{type:Boolean},readonly:{type:Boolean},placeholder:{type:String,defaultValue:undefined},name:{type:String},valuePrecision:{type:r.default,defaultValue:0},accessibleName:{type:String},accessibleNameRef:{type:String,defaultValue:""},_decIconDisabled:{type:Boolean,noAttribute:true},_incIconDisabled:{type:Boolean,noAttribute:true},focused:{type:Boolean},_inputFocused:{type:Boolean,noAttribute:true},_previousValue:{type:o.default,noAttribute:true},_previousValueState:{type:String,noAttribute:true,defaultValue:""},_waitTimeout:{type:o.default,noAttribute:true},_speed:{type:o.default,noAttribute:true},_btnDown:{type:Boolean,noAttribute:true},_spinTimeoutId:{type:r.default,noAttribute:true},_spinStarted:{type:Boolean,noAttribute:true}},slots:{valueStateMessage:{type:HTMLElement},formSupport:{type:HTMLElement}},events:{change:{}}};const g=500;const I=.8;const S=50;const V=120;class w extends t.default{constructor(){super()}static get metadata(){return b}static get render(){return l.default}static get styles(){return v.default}static get template(){return h.default}static get dependencies(){return[f.default,_.default]}static async onDefine(){w.i18nBundle=await(0,s.getI18nBundle)("@ui5/webcomponents")}get type(){return m.default.Number}get decIconTitle(){return w.i18nBundle.getText(d.STEPINPUT_DEC_ICON_TITLE)}get decIconName(){return"less"}get incIconTitle(){return w.i18nBundle.getText(d.STEPINPUT_INC_ICON_TITLE)}get incIconName(){return"add"}get _decIconClickable(){return!this._decIconDisabled&&!this.readonly&&!this.disabled}get _incIconClickable(){return!this._incIconDisabled&&!this.readonly&&!this.disabled}get _isFocused(){return this.focused}get _valuePrecisioned(){return this.value.toFixed(this.valuePrecision)}get accInfo(){return{ariaRequired:this.required,ariaLabel:(0,a.getEffectiveAriaLabelText)(this)}}get inputAttributes(){return{min:this.min===undefined?undefined:this.min,max:this.max===undefined?undefined:this.max,step:this.step}}onBeforeRendering(){this._setButtonState();if(this._previousValue===undefined){this._previousValue=this.value}const e=(0,n.getFeature)("FormSupport");if(e){e.syncNativeHiddenInput(this)}else if(this.name){console.warn(`In order for the "name" property to have effect, you should also: import "@ui5/webcomponents/dist/features/InputElementsFormSupport.js";`)}}get input(){return this.shadowRoot.querySelector("[ui5-input]")}get inputOuter(){return this.shadowRoot.querySelector(".ui5-step-input-input")}_onButtonFocusOut(){setTimeout(()=>{if(!this._inputFocused){this.inputOuter.removeAttribute("focused")}},0)}_onInputFocusIn(){this._inputFocused=true}_onInputFocusOut(){this._inputFocused=false;this._onInputChange()}_setButtonState(){this._decIconDisabled=this.min!==undefined&&this.value<=this.min;this._incIconDisabled=this.max!==undefined&&this.value>=this.max}_validate(){if(this._previousValueState===""){this._previousValueState=this.valueState!==""?this.valueState:u.default.None}this.valueState=this.min!==undefined&&this.value<this.min||this.max!==undefined&&this.value>this.max?u.default.Error:this._previousValueState}_preciseValue(e){const t=10**this.valuePrecision;return Math.round(e*t)/t}_fireChangeEvent(){if(this._previousValue!==this.value){this._previousValue=this.value;this.fireEvent("change",{value:this.value})}}_modifyValue(e,t){let i;this.value=this._preciseValue(parseFloat(this.input.value));i=this.value+e;if(this.min!==undefined&&i<this.min){i=this.min}if(this.max!==undefined&&i>this.max){i=this.max}i=this._preciseValue(i);if(i!==this.value){this.value=i;this._validate();this._setButtonState();this.focused=true;this.inputOuter.setAttribute("focused","");if(t){this._fireChangeEvent()}else{this.input.focus()}}}_incValue(e){if(this._incIconClickable&&e.isTrusted&&!this.disabled&&!this.readonly){this._modifyValue(this.step,true);this._previousValue=this.value}}_decValue(e){if(this._decIconClickable&&e.isTrusted&&!this.disabled&&!this.readonly){this._modifyValue(-this.step,true);this._previousValue=this.value}}_onInputChange(e){if(this.input.value===""){this.input.value=this.min||0}const t=this._preciseValue(parseFloat(this.input.value));if(this.value!==this._previousValue||this.value!==t){this.value=t;this._validate();this._setButtonState();this._fireChangeEvent()}}_onfocusin(){this.focused=true}_onfocusout(){this.focused=false}_onkeydown(e){let t=true;if(this.disabled||this.readonly){return}if((0,i.isEnter)(e)){this._onInputChange();return}if((0,i.isUp)(e)){this._modifyValue(this.step)}else if((0,i.isDown)(e)){this._modifyValue(-this.step)}else if((0,i.isEscape)(e)){this.value=this._previousValue;this.input.value=this.value.toFixed(this.valuePrecision)}else if(this.max!==undefined&&((0,i.isPageUpShift)(e)||(0,i.isUpShiftCtrl)(e))){this._modifyValue(this.max-this.value)}else if(this.min!==undefined&&((0,i.isPageDownShift)(e)||(0,i.isDownShiftCtrl)(e))){this._modifyValue(this.min-this.value)}else if(!(0,i.isUpCtrl)(e)&&!(0,i.isDownCtrl)(e)&&!(0,i.isUpShift)(e)&&!(0,i.isDownShift)(e)){t=false}if(t){e.preventDefault()}}_decSpin(){if(!this._decIconDisabled){this._spinValue(false,true)}}_incSpin(){if(!this._incIconDisabled){this._spinValue(true,true)}}_calcWaitTimeout(){this._speed*=I;this._waitTimeout=this._waitTimeout-this._speed<S?S:this._waitTimeout-this._speed;return this._waitTimeout}_spinValue(e,t){if(t){this._waitTimeout=g;this._speed=V;this._btnDown=true}this._spinTimeoutId=setTimeout(()=>{if(this._btnDown){this._spinStarted=true;this._modifyValue(e?this.step:-this.step);this._setButtonState();if(!this._incIconDisabled&&e||!this._decIconDisabled&&!e){this._spinValue(e)}else{this._resetSpin();this._fireChangeEvent()}}},this._calcWaitTimeout())}_resetSpin(){clearTimeout(this._spinTimeoutId);this._btnDown=false;this._spinStarted=false}_resetSpinOut(){if(this._btnDown){this._resetSpin();this._fireChangeEvent()}}}w.define();var T=w;e.default=T});
//# sourceMappingURL=StepInput.js.map