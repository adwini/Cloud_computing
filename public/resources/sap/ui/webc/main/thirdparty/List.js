sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/delegate/ItemNavigation","sap/ui/webc/common/thirdparty/base/Render","sap/ui/webc/common/thirdparty/base/util/TabbableElements","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/types/Integer","sap/ui/webc/common/thirdparty/base/types/NavigationMode","sap/ui/webc/common/thirdparty/base/util/AriaLabelHelper","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/base/util/debounce","sap/ui/webc/common/thirdparty/base/util/isElementInView","./types/ListMode","./types/ListGrowingMode","./types/ListSeparators","./BusyIndicator","./generated/templates/ListTemplate.lit","./generated/themes/List.css","./generated/themes/BrowserScrollbar.css","./generated/i18n/i18n-defaults"],function(e,t,i,s,r,o,n,l,a,d,u,h,c,f,m,g,p,b,I,y,E,w){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=v(t);i=v(i);s=v(s);r=v(r);a=v(a);d=v(d);c=v(c);f=v(f);m=v(m);g=v(g);p=v(p);b=v(b);I=v(I);y=v(y);E=v(E);function v(e){return e&&e.__esModule?e:{default:e}}const S=250;const _=10;const L={tag:"ui5-list",managedSlots:true,fastNavigation:true,slots:{header:{type:HTMLElement},default:{propertyName:"items",type:HTMLElement}},properties:{headerText:{type:String},footerText:{type:String},indent:{type:Boolean},mode:{type:m.default,defaultValue:m.default.None},noDataText:{type:String},separators:{type:p.default,defaultValue:p.default.All},growing:{type:g.default,defaultValue:g.default.None},busy:{type:Boolean},busyDelay:{type:a.default,defaultValue:1e3},accessibleName:{type:String},accessibleNameRef:{type:String,defaultValue:""},accessibleRole:{type:String,defaultValue:"list"},_inViewport:{type:Boolean},_loadMoreActive:{type:Boolean}},events:{"item-click":{detail:{item:{type:HTMLElement}}},"item-close":{detail:{item:{type:HTMLElement}}},"item-toggle":{detail:{item:{type:HTMLElement}}},"item-delete":{detail:{item:{type:HTMLElement}}},"selection-change":{detail:{selectedItems:{type:Array},previouslySelectedItems:{type:Array},selectionComponentPressed:{type:Boolean}}},"load-more":{}}};class F extends t.default{static get metadata(){return L}static get render(){return i.default}static get template(){return I.default}static get styles(){return[E.default,y.default]}static async onDefine(){F.i18nBundle=await(0,h.getI18nBundle)("@ui5/webcomponents")}static get dependencies(){return[b.default]}constructor(){super();this.initItemNavigation();this._previouslyFocusedItem=null;this._forwardingFocus=false;this._previouslySelectedItem=null;this.resizeListenerAttached=false;this.listEndObserved=false;this.addEventListener("ui5-_press",this.onItemPress.bind(this));this.addEventListener("ui5-close",this.onItemClose.bind(this));this.addEventListener("ui5-toggle",this.onItemToggle.bind(this));this.addEventListener("ui5-_focused",this.onItemFocused.bind(this));this.addEventListener("ui5-_forward-after",this.onForwardAfter.bind(this));this.addEventListener("ui5-_forward-before",this.onForwardBefore.bind(this));this.addEventListener("ui5-_selection-requested",this.onSelectionRequested.bind(this));this.addEventListener("ui5-_focus-requested",this.focusUploadCollectionItem.bind(this));this._handleResize=this.checkListInViewport.bind(this);this.initialIntersection=true}onExitDOM(){this.unobserveListEnd();this.resizeListenerAttached=false;s.default.deregister(this.getDomRef(),this._handleResize)}onBeforeRendering(){this.prepareListItems()}onAfterRendering(){if(this.growsOnScroll){this.observeListEnd()}else if(this.listEndObserved){this.unobserveListEnd()}if(this.grows){this.checkListInViewport();this.attachForResize()}}attachForResize(){if(!this.resizeListenerAttached){this.resizeListenerAttached=true;s.default.register(this.getDomRef(),this._handleResize)}}get shouldRenderH1(){return!this.header.length&&this.headerText}get headerID(){return`${this._id}-header`}get modeLabelID(){return`${this._id}-modeLabel`}get listEndDOM(){return this.shadowRoot.querySelector(".ui5-list-end-marker")}get hasData(){return this.getSlottedNodes("items").length!==0}get showNoDataText(){return!this.hasData&&this.noDataText}get isDelete(){return this.mode===m.default.Delete}get isSingleSelect(){return[m.default.SingleSelect,m.default.SingleSelectBegin,m.default.SingleSelectEnd,m.default.SingleSelectAuto].includes(this.mode)}get isMultiSelect(){return this.mode===m.default.MultiSelect}get ariaLabelledBy(){if(this.accessibleNameRef||this.accessibleName){return undefined}const e=[];if(this.isMultiSelect||this.isSingleSelect||this.isDelete){e.push(this.modeLabelID)}if(this.shouldRenderH1){e.push(this.headerID)}return e.length?e.join(" "):undefined}get ariaLabelTxt(){return(0,u.getEffectiveAriaLabelText)(this)}get ariaLabelModeText(){if(this.isMultiSelect){return F.i18nBundle.getText(w.ARIA_LABEL_LIST_MULTISELECTABLE)}if(this.isSingleSelect){return F.i18nBundle.getText(w.ARIA_LABEL_LIST_SELECTABLE)}if(this.isDelete){return F.i18nBundle.getText(w.ARIA_LABEL_LIST_DELETABLE)}return undefined}get grows(){return this.growing!==g.default.None}get growsOnScroll(){return this.growing===g.default.Scroll}get growsWithButton(){return this.growing===g.default.Button}get _growingButtonText(){return F.i18nBundle.getText(w.LOAD_MORE_TEXT)}get busyIndPosition(){if(!this.grows){return"absolute"}return this._inViewport?"absolute":"sticky"}get styles(){return{busyInd:{position:this.busyIndPosition}}}initItemNavigation(){this._itemNavigation=new r.default(this,{skipItemsSize:_,navigationMode:d.default.Vertical,getItemsCallback:()=>this.getEnabledItems()})}prepareListItems(){const e=this.getSlottedNodes("items");e.forEach((t,i)=>{const s=i===e.length-1;const r=this.separators===p.default.All||this.separators===p.default.Inner&&!s;t._mode=this.mode;t.hasBorder=r});this._previouslySelectedItem=null}async observeListEnd(){if(!this.listEndObserved){await(0,o.renderFinished)();this.getIntersectionObserver().observe(this.listEndDOM);this.listEndObserved=true}}unobserveListEnd(){if(this.growingIntersectionObserver){this.growingIntersectionObserver.disconnect();this.growingIntersectionObserver=null;this.listEndObserved=false}}onInteresection(e){if(this.initialIntersection){this.initialIntersection=false;return}e.forEach(e=>{if(e.isIntersecting){(0,c.default)(this.loadMore.bind(this),S)}})}onSelectionRequested(e){const t=this.getSelectedItems();let i=false;this._selectionRequested=true;if(this[`handle${this.mode}`]){i=this[`handle${this.mode}`](e.detail.item,e.detail.selected)}if(i){this.fireEvent("selection-change",{selectedItems:this.getSelectedItems(),previouslySelectedItems:t,selectionComponentPressed:e.detail.selectionComponentPressed,key:e.detail.key})}}handleSingleSelect(e){if(e.selected){return false}this.deselectSelectedItems();e.selected=true;return true}handleSingleSelectBegin(e){return this.handleSingleSelect(e)}handleSingleSelectEnd(e){return this.handleSingleSelect(e)}handleSingleSelectAuto(e){return this.handleSingleSelect(e)}handleMultiSelect(e,t){e.selected=t;return true}handleDelete(e){this.fireEvent("item-delete",{item:e})}deselectSelectedItems(){this.getSelectedItems().forEach(e=>{e.selected=false})}getSelectedItems(){return this.getSlottedNodes("items").filter(e=>e.selected)}getEnabledItems(){return this.getSlottedNodes("items").filter(e=>!e.disabled)}_onkeydown(e){if((0,l.isTabNext)(e)){this._handleTabNext(e)}}_onLoadMoreKeydown(e){if((0,l.isSpace)(e)){e.preventDefault();this._loadMoreActive=true}if((0,l.isEnter)(e)){this._onLoadMoreClick();this._loadMoreActive=true}if((0,l.isTabNext)(e)){this.focusAfterElement()}if((0,l.isTabPrevious)(e)){if(this.getPreviouslyFocusedItem()){this.focusPreviouslyFocusedItem()}else{this.focusFirstItem()}e.preventDefault()}}_onLoadMoreKeyup(e){if((0,l.isSpace)(e)){this._onLoadMoreClick()}this._loadMoreActive=false}_onLoadMoreMousedown(){this._loadMoreActive=true}_onLoadMoreMouseup(){this._loadMoreActive=false}_onLoadMoreClick(){this.loadMore()}checkListInViewport(){this._inViewport=(0,f.default)(this.getDomRef())}loadMore(){this.fireEvent("load-more")}_handleTabNext(e){let t;const i=this.getNormalizedTarget(e.target);if(this.headerToolbar){t=this.getHeaderToolbarLastTabbableElement()}if(!t){return}if(t===i){if(this.getFirstItem(e=>e.selected&&!e.disabled)){this.focusFirstSelectedItem()}else if(this.getPreviouslyFocusedItem()){this.focusPreviouslyFocusedItem()}else{this.focusFirstItem()}e.stopImmediatePropagation();e.preventDefault()}}_onfocusin(e){const t=this.getNormalizedTarget(e.target);if(!this.isForwardElement(t)){e.stopImmediatePropagation();return}if(!this.getPreviouslyFocusedItem()){if(this.growsWithButton&&this.isForwardAfterElement(t)){this.focusGrowingButton()}else{this.focusFirstItem()}e.stopImmediatePropagation();return}if(!this.getForwardingFocus()){if(this.growsWithButton&&this.isForwardAfterElement(t)){this.focusGrowingButton();e.stopImmediatePropagation();return}this.focusPreviouslyFocusedItem();e.stopImmediatePropagation()}this.setForwardingFocus(false)}isForwardElement(e){const t=e.id;const i=this.getBeforeElement();if(this._id===t||i&&i.id===t){return true}return this.isForwardAfterElement(e)}isForwardAfterElement(e){const t=e.id;const i=this.getAfterElement();return i&&i.id===t}onItemFocused(e){const t=e.target;this._itemNavigation.setCurrentItem(t);this.fireEvent("item-focused",{item:t});if(this.mode===m.default.SingleSelectAuto){this.onSelectionRequested({detail:{item:t,selectionComponentPressed:false,selected:true,key:e.detail.key}})}}onItemPress(e){const t=e.detail.item;if(!this.fireEvent("item-click",{item:t},true)){return}if(!this._selectionRequested&&this.mode!==m.default.Delete){this._selectionRequested=true;this.onSelectionRequested({detail:{item:t,selectionComponentPressed:false,selected:!t.selected,key:e.detail.key}})}this._selectionRequested=false}onItemClose(e){this.fireEvent("item-close",{item:e.detail.item})}onItemToggle(e){this.fireEvent("item-toggle",{item:e.detail.item})}onForwardBefore(e){this.setPreviouslyFocusedItem(e.target);this.focusBeforeElement();e.stopImmediatePropagation()}onForwardAfter(e){this.setPreviouslyFocusedItem(e.target);if(!this.growsWithButton){this.focusAfterElement()}else{this.focusGrowingButton();e.preventDefault()}}focusBeforeElement(){this.setForwardingFocus(true);this.getBeforeElement().focus()}focusAfterElement(){this.setForwardingFocus(true);this.getAfterElement().focus()}focusGrowingButton(){const e=this.getGrowingButton();if(e){e.focus()}}getGrowingButton(){return this.shadowRoot.querySelector(`#${this._id}-growing-btn`)}focusFirstItem(){const e=this.getFirstItem(e=>!e.disabled);if(e){e.focus()}}focusPreviouslyFocusedItem(){const e=this.getPreviouslyFocusedItem();if(e){e.focus()}}focusFirstSelectedItem(){const e=this.getFirstItem(e=>e.selected&&!e.disabled);if(e){e.focus()}}focusItem(e){this._itemNavigation.setCurrentItem(e);e.focus()}focusUploadCollectionItem(e){setTimeout(()=>{this.setPreviouslyFocusedItem(e.target);this.focusPreviouslyFocusedItem()},0)}setForwardingFocus(e){this._forwardingFocus=e}getForwardingFocus(){return this._forwardingFocus}setPreviouslyFocusedItem(e){this._previouslyFocusedItem=e}getPreviouslyFocusedItem(){return this._previouslyFocusedItem}getFirstItem(e){const t=this.getSlottedNodes("items");let i=null;if(!e){return!!t.length&&t[0]}for(let s=0;s<t.length;s++){if(e(t[s])){i=t[s];break}}return i}getAfterElement(){if(!this._afterElement){this._afterElement=this.shadowRoot.querySelector(`#${this._id}-after`)}return this._afterElement}getBeforeElement(){if(!this._beforeElement){this._beforeElement=this.shadowRoot.querySelector(`#${this._id}-before`)}return this._beforeElement}getHeaderToolbarLastTabbableElement(){return(0,n.getLastTabbableElement)(this.headerToolbar.getDomRef())||this.headerToolbar.getDomRef()}getNormalizedTarget(e){let t=e;if(e.shadowRoot&&e.shadowRoot.activeElement){t=e.shadowRoot.activeElement}return t}getIntersectionObserver(){if(!this.growingIntersectionObserver){this.growingIntersectionObserver=new IntersectionObserver(this.onInteresection.bind(this),{root:null,rootMargin:"0px",threshold:1})}return this.growingIntersectionObserver}}F.define();var T=F;e.default=T});
//# sourceMappingURL=List.js.map