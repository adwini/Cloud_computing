sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/base/delegate/ItemNavigation","sap/ui/webc/common/thirdparty/base/types/CSSColor","sap/ui/webc/common/thirdparty/base/types/ItemNavigationBehavior","sap/ui/webc/common/thirdparty/base/Device","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/FeaturesRegistry","./generated/templates/ColorPaletteTemplate.lit","./generated/templates/ColorPaletteDialogTemplate.lit","./ColorPaletteItem","./Button","./generated/i18n/i18n-defaults","./generated/themes/ColorPalette.css","./generated/themes/ColorPaletteStaticArea.css"],function(e,t,o,s,i,l,r,a,n,h,c,u,C,f,d,g,p){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=m(t);o=m(o);i=m(i);l=m(l);r=m(r);c=m(c);u=m(u);C=m(C);f=m(f);g=m(g);p=m(p);function m(e){return e&&e.__esModule?e:{default:e}}const w={tag:"ui5-color-palette",managedSlots:true,properties:{showRecentColors:{type:Boolean},showMoreColors:{type:Boolean},showDefaultColor:{type:Boolean},defaultColor:{type:l.default},_selectedColor:{type:l.default},popupMode:{type:Boolean}},slots:{default:{propertyName:"colors",type:HTMLElement,invalidateOnChildChange:true,individualSlots:true}},events:{"item-click":{detail:{color:{type:String}}}}};class _ extends t.default{static get metadata(){return w}static get render(){return o.default}static get styles(){return g.default}static get staticAreaStyles(){return p.default}static get template(){return c.default}static get staticAreaTemplate(){return u.default}static get dependencies(){const e=(0,h.getFeature)("ColorPaletteMoreColors");return[C.default,f.default].concat(e?e.dependencies:[])}static async onDefine(){const e=(0,h.getFeature)("ColorPaletteMoreColors");[_.i18nBundle]=await Promise.all([(0,s.getI18nBundle)("@ui5/webcomponents"),e?e.init():Promise.resolve()])}constructor(){super();this._itemNavigation=new i.default(this,{getItemsCallback:()=>this.displayedColors,rowSize:this.rowSize,behavior:r.default.Cyclic});this._itemNavigationRecentColors=new i.default(this,{getItemsCallback:()=>this.recentColorsElements,rowSize:this.rowSize,behavior:r.default.Static});this._recentColors=[]}onBeforeRendering(){this.displayedColors.forEach((e,t)=>{e.index=t+1});if(this.showMoreColors){const e=(0,h.getFeature)("ColorPaletteMoreColors");if(e){this.moreColorsFeature=new e}else{throw new Error(`You have to import "@ui5/webcomponents/dist/features/ColorPaletteMoreColors.js" module to use the more-colors functionality.`)}}}selectColor(e){if(!e.value){return}e.focus();if(this.displayedColors.includes(e)){this._itemNavigation.setCurrentItem(e)}this._setColor(e.value)}_setColor(e){this._selectedColor=e;if(this._recentColors[0]!==this._selectedColor){if(this._recentColors.includes(this._selectedColor)){this._recentColors.unshift(this._recentColors.splice(this._recentColors.indexOf(this._selectedColor),1)[0])}else{this._recentColors.unshift(this._selectedColor)}}this.fireEvent("item-click",{color:this._selectedColor})}_onclick(e){if(e.target.hasAttribute("ui5-color-palette-item")){this.selectColor(e.target)}}_onkeyup(e){if((0,n.isSpace)(e)&&e.target.hasAttribute("ui5-color-palette-item")){e.preventDefault();this.selectColor(e.target)}}_onkeydown(e){if((0,n.isEnter)(e)&&e.target.hasAttribute("ui5-color-palette-item")){this.selectColor(e.target)}}_onDefaultColorKeyDown(e){if((0,n.isTabNext)(e)&&this.popupMode){e.preventDefault();this._onDefaultColorClick()}if((0,n.isDown)(e)){e.stopPropagation();this.focusColorElement(this.colorPaletteNavigationElements[1],this._itemNavigation)}else if((0,n.isUp)(e)){e.stopPropagation();const t=this.colorPaletteNavigationElements[this.colorPaletteNavigationElements.length-1];if(this.hasRecentColors){this.focusColorElement(t,this._itemNavigationRecentColors)}else if(this.showMoreColors){t.focus()}else{const e=this.displayedColors.length%this.rowSize*this.rowSize;this.focusColorElement(this.displayedColors[e],this._itemNavigation)}}}_onMoreColorsKeyDown(e){const t=this.colorPaletteNavigationElements.indexOf(e.target);const o=this.displayedColors.length%this.rowSize*this.rowSize;if((0,n.isUp)(e)){e.stopPropagation();this.focusColorElement(this.displayedColors[o],this._itemNavigation)}else if((0,n.isDown)(e)){e.stopPropagation();if(this.hasRecentColors){this.focusColorElement(this.colorPaletteNavigationElements[t+1],this._itemNavigationRecentColors)}else if(this.showDefaultColor){this.colorPaletteNavigationElements[0].focus()}else{this.focusColorElement(this.displayedColors[0],this._itemNavigation)}}}_onColorContainerKeyDown(e){const t=this.colorPaletteNavigationElements[this.colorPaletteNavigationElements.length-1];if((0,n.isTabNext)(e)&&this.popupMode){e.preventDefault();this.selectColor(e.target)}if((0,n.isUp)(e)&&e.target===this.displayedColors[0]&&this.colorPaletteNavigationElements.length>1){e.stopPropagation();if(this.showDefaultColor){this.colorPaletteNavigationElements[0].focus()}else if(!this.showDefaultColor&&this.hasRecentColors){this.focusColorElement(t,this._itemNavigationRecentColors)}else if(!this.showDefaultColor&&this.showMoreColors){t.focus()}}else if((0,n.isDown)(e)&&e.target===this.displayedColors[this.displayedColors.length-1]&&this.colorPaletteNavigationElements.length>1){e.stopPropagation();const o=this.showDefaultColor&&!this.showMoreColors&&this.hasRecentColors||!this.showDefaultColor&&!this.showMoreColors&&this.hasRecentColors;if(this.showDefaultColor&&this.showMoreColors){this.colorPaletteNavigationElements[2].focus()}else if(this.showDefaultColor&&!this.showMoreColors&&(!this.showRecentColors||!this.recentColors[0])){this.colorPaletteNavigationElements[0].focus()}else if(o){this.focusColorElement(t,this._itemNavigationRecentColors)}else if(!this.showDefaultColor&&this.showMoreColors){this.colorPaletteNavigationElements[1].focus()}}}_onRecentColorsContainerKeyDown(e){if((0,n.isUp)(e)){if(this.showMoreColors){this.colorPaletteNavigationElements[1+this.showDefaultColor].focus()}else if(!this.showMoreColors&&this.colorPaletteNavigationElements.length>1){const t=this.displayedColors.length%this.rowSize*this.rowSize;e.stopPropagation();this.focusColorElement(this.displayedColors[t],this._itemNavigation)}}else if((0,n.isDown)(e)){if(this.showDefaultColor){this.colorPaletteNavigationElements[0].focus()}else{e.stopPropagation();this.focusColorElement(this.displayedColors[0],this._itemNavigation)}}}focusColorElement(e,t){t.setCurrentItem(e);t._focusCurrentItem()}async _chooseCustomColor(){const e=await this.getColorPicker();this._setColor(e.color);this._closeDialog()}async _closeDialog(){const e=await this._getDialog();e.close()}async _openMoreColorsDialog(){const e=await this._getDialog();e.show()}_onDefaultColorClick(){if(this.defaultColor){this._setColor(this.defaultColor)}}get selectedColor(){return this._selectedColor}get displayedColors(){return this.getSlottedNodes("colors").filter(e=>e.value).slice(0,15)}get colorContainerLabel(){return _.i18nBundle.getText(d.COLORPALETTE_CONTAINER_LABEL)}get colorPaleteMoreColorsText(){return _.i18nBundle.getText(d.COLOR_PALETTE_MORE_COLORS_TEXT)}get _showMoreColors(){return this.showMoreColors&&this.moreColorsFeature}get rowSize(){return 5}get hasRecentColors(){return this.showRecentColors&&this.recentColors[0]}get recentColors(){if(this._recentColors.length>this.rowSize){this._recentColors=this._recentColors.slice(0,this.rowSize)}while(this._recentColors.length<this.rowSize){this._recentColors.push("")}return this._recentColors}get recentColorsElements(){if(this.getDomRef()){return Array.from(this.getDomRef().querySelectorAll(".ui5-cp-recent-colors-wrapper [ui5-color-palette-item]")).filter(e=>e.value!=="")}return[]}get colorPaletteNavigationElements(){const e=[];const t=this.shadowRoot.querySelector(".ui5-cp-root");if(this.showDefaultColor){e.push(t.querySelector(".ui5-cp-default-color-button"))}e.push(this.displayedColors[0]);if(this.showMoreColors){e.push(t.querySelector(".ui5-cp-more-colors"))}if(this.showRecentColors&&!!this.recentColorsElements.length){e.push(this.recentColorsElements[0])}return e}get classes(){return{colorPaletteRoot:{"ui5-cp-root":true,"ui5-cp-root-phone":(0,a.isPhone)()}}}async _getDialog(){const e=await this.getStaticAreaItemDomRef();return e.querySelector("[ui5-dialog]")}async getColorPicker(){const e=await this._getDialog();return e.content[0].querySelector("[ui5-color-picker]")}}_.define();var y=_;e.default=y});
//# sourceMappingURL=ColorPalette.js.map