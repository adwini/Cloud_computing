sap.ui.define(["exports","sap/ui/webc/common/thirdparty/base/delegate/ItemNavigation","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/Device","sap/ui/webc/common/thirdparty/base/MediaRange","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/types/Integer","sap/ui/webc/common/thirdparty/base/types/NavigationMode","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/main/thirdparty/Button","sap/ui/webc/main/thirdparty/Carousel","./MediaGalleryItem","./types/MediaGalleryItemLayout","./types/MediaGalleryLayout","./types/MediaGalleryMenuHorizontalAlign","./types/MediaGalleryMenuVerticalAlign","./generated/templates/MediaGalleryTemplate.lit","./generated/themes/MediaGallery.css"],function(e,t,i,a,s,l,n,r,o,u,d,h,c,m,f,_,g,y){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;t=p(t);i=p(i);s=p(s);l=p(l);n=p(n);r=p(r);o=p(o);u=p(u);d=p(d);h=p(h);c=p(c);m=p(m);f=p(f);_=p(_);g=p(g);y=p(y);function p(e){return e&&e.__esModule?e:{default:e}}const I={S:1,M:2,L:3,XL:4};const v={tag:"ui5-media-gallery",managedSlots:true,slots:{default:{propertyName:"items",type:HTMLElement,individualSlots:true,invalidateOnChildChange:true}},properties:{showAllThumbnails:{type:Boolean},interactiveDisplayArea:{type:Boolean},layout:{type:m.default,defaultValue:"Auto"},menuHorizontalAlign:{type:f.default,defaultValue:f.default.Left},menuVerticalAlign:{type:_.default,defaultValue:_.default.Bottom},effectiveLayout:{type:m.default,defaultValue:"Vertical"},mediaRange:{type:String},_overflowSize:{type:n.default,noAttribute:true,defaultValue:0}},events:{"selection-change":{detail:{item:{type:HTMLElement}}},"overflow-click":{},"display-area-click":{}}};class b extends o.default{constructor(){super();this._onResize=this._updateLayout.bind(this);this._selectedItem=null;this._initItemNavigation()}onEnterDOM(){!(0,a.isPhone)()&&i.default.register(this,this._onResize)}onExitDOM(){!(0,a.isPhone)()&&i.default.deregister(this,this._onResize)}onAfterRendering(){this._updateLayout();this._updateSelection()}_initItemNavigation(){if(!this._itemNavigation){this._itemNavigation=new t.default(this,{navigationMode:r.default.Auto,getItemsCallback:()=>this._getFocusableItems()})}}_updateSelection(){let e=this.items.find(e=>e.selected);if(!e||!this._isSelectableItem(e)){e=this._findSelectableItem()}if(e&&e!==this._selectedItem){this._selectItem(e)}}_isSelectableItem(e){return!e.disabled&&!e.hidden}_findSelectableItem(){return this.items.find(this._isSelectableItem)}_updateMediaRange(e){this.mediaRange=s.default.getCurrentRange(s.default.RANGESETS.RANGE_4STEPS,e)}_updateLayout(){const e=this.getDomRef(),t=e.offsetHeight,i=e.offsetWidth;if(!i||!t||(0,a.isPhone)()){return}this._updateMediaRange(i);this.effectiveLayout=this._infereffectiveLayout();this._overflowSize=this._calculateOverflowSize(i,t);this._toggleDisplaySquareSize(this._shouldHaveSquareDisplay);this._toggleMainItem9x16size(this._shouldHaveWideDisplay)}_calculateOverflowSize(e,t){const i=b.THUMBNAIL_MARGIN;let a,s;if(this.showAllThumbnails){return 0}if(this.effectiveLayout===m.default.Horizontal){a=t-i;s=this.showAllThumbnails?I[this.mediaRange]:1}else{a=e-i*2;s=1}return this._getOverflowSize(a,s)}_toggleDisplaySquareSize(e){this._display.style.width="";if(e){const e=b.THUMBNAIL_MARGIN,t=this._display.offsetWidth;let i=this.getDomRef().offsetHeight-2*e;if(this.effectiveLayout===m.default.Vertical){i-=b.THUMBNAIL_HEIGHT+e}if(t>i){this._display.style.width=`${i}px`}}}_toggleMainItem9x16size(e){if(!this._mainItem){return}const t=this._mainItem.offsetWidth,i=e?`${t/16*9}px`:"";this._mainItem.contentHeight=i}_infereffectiveLayout(){if(this.layout===m.default.Auto){return this._isPhoneSize?m.default.Vertical:m.default.Horizontal}return this.layout}_getMaxAllowedThumbnailsInColumn(e){let t=Math.floor(e/b.THUMBNAIL_HEIGHT);if(!this.showAllThumbnails){t=Math.min(t,5)}return t}_getOverflowSize(e,t){const i=this._getMaxAllowedThumbnailsInColumn(e),a=Math.max(0,this.items.length-i*t);if(a===this.items.length||a===0){return a}return a+1}_getFocusableItems(){if(!this._showThumbnails){return[]}const e=this._visibleItems.filter(e=>!e.disabled);if(this._overflowBtn){e.push(this._overflowBtn)}return e}_selectItem(e,t){if(e===this._selectedItem){return}this._selectedItem=e;this._updateSelectedFlag(e);this._itemNavigation.setCurrentItem(e);if(t){this.fireEvent("selection-change",{item:e})}if((0,a.isPhone)()){this._selectItemOnPhone(e)}else{this._displayContent(e)}}_updateSelectedFlag(e){this.items.forEach(e=>{e.selected=false});e.selected=true}_selectItemOnPhone(e){const t=this._selectableItems.indexOf(e),i=this._carousel;i&&i.navigateTo(t)}_displayContent(e){let t;const i=this._mainItem,a=i._content,s=e._content;i._thumbnailDesign=false;a&&a.remove();if(s){t=s.cloneNode(true);i.layout=e.layout;i.appendChild(t)}}_onThumbnailClick(e){const t=e.target.closest("[ui5-media-gallery-item]");if(t.disabled){return}if(t!==this._selectedItem){this._selectItem(t,true)}}_onOverflowBtnClick(){this.fireEvent("overflow-click")}_onDisplayAreaClick(e){if(!this.interactiveDisplayArea){return}this.fireEvent("display-area-click")}_onCarouselNavigate(e){const t=e.detail.selectedIndex,i=this._selectableItems[t];this.fireEvent("selection-change",{item:i})}get _mainItemTabIndex(){return this.interactiveDisplayArea?0:undefined}get _selectableItems(){return this.items.filter(this._isSelectableItem)}get _carousel(){return this.shadowRoot.querySelector("[ui5-carousel]")}get _display(){return this.shadowRoot.querySelector(".ui5-media-gallery-display")}get _mainItem(){return this.shadowRoot.querySelector(".ui5-media-gallery-display [ui5-media-gallery-item]")}get _overflowBtn(){return this.shadowRoot.querySelector(".ui5-media-gallery-overflow [ui5-button]")}get _visibleItems(){const e=this.items.length-this._overflowSize;return this.items.slice(0,e)}get _isPhonePlatform(){return(0,a.isPhone)()}get _showThumbnails(){return!(0,a.isPhone)()}get _showOverflowBtn(){return this._overflowSize>0}get _isPhoneSize(){return this.mediaRange==="S"}get _mainItemHasWideLayout(){return this._mainItem&&this._mainItem.layout===c.default.Wide}get _shouldHaveWideDisplay(){return this._mainItemHasWideLayout&&this.showAllThumbnails&&this.effectiveLayout===m.default.Horizontal}get _shouldHaveSquareDisplay(){return!this._shouldHaveWideDisplay}static get metadata(){return v}static get render(){return l.default}static get template(){return g.default}static get staticAreaTemplate(){return g.default}static get styles(){return[y.default]}static get staticAreaStyles(){return null}static get dependencies(){return[h.default,u.default,d.default]}static get THUMBNAIL_HEIGHT(){return 80}static get THUMBNAIL_MARGIN(){return 16}}b.define();var w=b;e.default=w});
//# sourceMappingURL=MediaGallery.js.map